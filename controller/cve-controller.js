import Cve from '../model/cveSchema.js';
import escapeStringRegexp from 'escape-string-regexp';

export const getCves = async (request, response) => {
    try {


        let where = {
            month: request.params.month,
            year: request.params.year
        };

        const cves = await Cve.find(where);

        response.json(cves);
    } catch (error) {

    }
};

export const getCveData = async (request, response) => {
    try {


        let where = {
            month: request.params.month,
            year: request.params.year
        };

        const cves = await Cve.find(where);

        response.json(cves);
    } catch (error) {

    }
};


export const searchCve = async (request, response) => {
    try {

        // let where = {
        //     cveId: request.params.cveId          
        //   };
        const $regex = escapeStringRegexp(request.params.cveId);
        const cves = await Cve.find({ cveId: { $regex } });

        response.json(cves);
    } catch (error) {

    }
};